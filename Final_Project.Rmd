---
title: "Analysis of salaries of data scientists"
author: "Group 12"
date: "December 1st, 2024"
output: pdf_document
---

-   Egbo Joseph (143037470)
-   Goudy Joshua (169031329)
-   Thambiaiah Melissa (169060509)
-   Umar Emaan (169108097)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
```

```{r import}
grapes_0<-read_csv('GRAPE_QUALITY.csv')
```

```{r data_cleaning}
grapes<-grapes_0|>
  select(!(sample_id))
grapes$quality_category<-factor(grapes$quality_category, levels = c('Low', 'Medium', 'High', 'Premium'))
grapes<-grapes|>
  mutate(wine_type = case_when(
        variety == 'Riesling' ~ 'White',
        variety == 'Pinot Noir' ~ 'Red',
        variety == 'Sauvignon Blanc'~'White',
        variety == 'Merlot'~'Red',
        variety == 'Zinfandel'~'Red',
        variety == 'Chardonnay'~'White',
        variety == 'Syrah'~'Red',
        variety == 'Cabernet Sauvignon'~'Red',
        .default = variety
      ),
      harvest_week = as.integer(week(harvest_date)) - 30
      )
```

```{r}
percentile_by_region<-grapes|>
  group_by(region)|>
  mutate(r_count = n())|>
  group_by(region, quality_category)|>
  mutate(count = n(),
         percent = (count/r_count) * 100,
         percent = round(percent, 1))|>
  select(region, quality_category, percent)|>
  unique()|>
  arrange(region, quality_category)|>
  pivot_wider(names_from = quality_category, values_from = percent)
```

```{r}
cor(grapes$harvest_week, grapes$quality_score)
```

cor to quality sugar: 0.6900412 acidity: 0.004675939 cluster_weight: -0.004672546 berry_size: 0.4783609 sun: 0.5426107 soil: 0.04112437 rain: 0.02780617 week: -0.03863471

```{r}
grapes_split <- initial_validation_split(grapes, prop = c(0.6, 0.2))

set.seed(1000)

grapes_train <- training(grapes_split)

grapes_valid <- vadilation(grapes_split)

grapes_test <- testing(grapes_split)


```
