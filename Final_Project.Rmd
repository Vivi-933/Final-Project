---
title: "Analysis of salaries of data scientists"
author: "Group 12"
date: "December 1st, 2024"
output: pdf_document
---

-   Egbo Joseph (143037470)
-   Goudy Joshua (169031329)
-   Thambiaiah Melissa (169060509)
-   Umar Emaan (169108097)


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(quantmod)
```

```{r salaries}
salaries <- read.csv('ds_salaries.csv')
z = getFX("USD/CAD", from = Sys.Date() - 1, to = Sys.Date())
rate <- as.numeric(USDCAD$USD.CAD[1])
salaries_CAD <- salaries|>
  mutate(salary_in_usd = as.integer(salary_in_usd * rate))|>
  rename(salary_in_CAD = salary_in_usd) 
```

```{r}
by_job<-salaries_CAD|>
  group_by(job_title)|>
  mutate(average = mean(salary_in_CAD))|>
  select(job_title, average)|>
  unique()|>
  arrange(job_title)

by_year<-salaries_CAD|>
  group_by(work_year)|>
  mutate(average = mean(salary_in_CAD))|>
  select(work_year, average)|>
  unique()|>
  arrange(work_year)

salaries_CAD$experience_level <- factor(salaries_CAD$experience_level, levels = c('EN', 'MI', 'SE', 'EX'))
by_experience<-salaries_CAD|>
  group_by(experience_level)|>
  mutate(average = mean(salary_in_CAD))|>
  select(experience_level, average)|>
  unique()

by_year_and_ex<-salaries_CAD|>
  group_by(experience_level, work_year)|>
  mutate(average = mean(salary_in_CAD))|>
  select(experience_level, work_year, average)|>
  mutate(average = average/1000, average = round(average, 1))|>
  unique()|>
  mutate(ex_year = paste(work_year, experience_level, sep = "_"))|>
  arrange(work_year,experience_level)

by_year_and_ex$experience_level <- factor(by_year_and_ex$experience_level, levels = c('EN', 'MI', 'SE', 'EX'))

by_residence<-salaries_CAD|>
  group_by(employee_residence)|>
  mutate(residence_average = mean(salary_in_CAD))|>
  select(employee_residence, residence_average)|>
  unique()


```

```{r}
ggplot(by_year_and_ex)+
    geom_col(mapping = aes(x = ex_year, y = average, fill = experience_level), colour = 'black')+
    theme(axis.text.x = element_text(angle = 90, hjust = 1))+
    labs(y = 'average(k)')
```