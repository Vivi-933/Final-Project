---
title: "Analysis of salaries of data scientists"
author: "Group 12"
date: "December 1st, 2024"
output: pdf_document
---

-   Egbo Joseph (143037470)
-   Goudy Joshua (169031329)
-   Thambiaiah Melissa (169060509)
-   Umar Emaan (169108097)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(scatterplot3d)
```

```{r import}
grapes_0<-read_csv('GRAPE_QUALITY.csv')
```

```{r data_cleaning}
grapes<-grapes_0|>
  select(!(sample_id))
grapes$quality_category<-factor(grapes$quality_category, levels = c('Low', 'Medium', 'High', 'Premium'))
grapes<-grapes|>
  mutate(wine_type = case_when(
        variety == 'Riesling' ~ 'White',
        variety == 'Pinot Noir' ~ 'Red',
        variety == 'Sauvignon Blanc'~'White',
        variety == 'Merlot'~'Red',
        variety == 'Zinfandel'~'Red',
        variety == 'Chardonnay'~'White',
        variety == 'Syrah'~'Red',
        variety == 'Cabernet Sauvignon'~'Red',
        .default = variety
      ),
      harvest_week = as.integer(week(harvest_date)) - 30
      )
```

```{r}
percentile_by_region<-grapes|>
  group_by(region)|>
  mutate(r_count = n())|>
  group_by(region, quality_category)|>
  mutate(count = n(),
         percent = (count/r_count) * 100,
         percent = round(percent, 1))|>
  select(region, quality_category, percent)|>
  unique()|>
  arrange(region, quality_category)|>
  pivot_wider(names_from = quality_category, values_from = percent)
```

```{r}
cor(grapes$sugar_content_brix, grapes$acidity_ph)
cor(grapes$sugar_content_brix, grapes$cluster_weight_g)
cor(grapes$sugar_content_brix, grapes$berry_size_mm)
cor(grapes$sugar_content_brix, grapes$sun_exposure_hours)
cor(grapes$sugar_content_brix, grapes$soil_moisture_percent)
cor(grapes$rainfall_mm, grapes$soil_moisture_percent)
cor(grapes$sugar_content_brix, grapes$rainfall_mm)
cor(grapes$sugar_content_brix, grapes$harvest_week)
```

cor to quality sugar: 0.6900412 acidity: 0.004675939 cluster_weight: -0.004672546 berry_size: 0.4783609 sun: 0.5426107 soil: 0.04112437 rain: 0.02780617 week: -0.03863471

```{r}

grapes |> 
  correlate() |> 
  focus(sugar_content_brix)

grapes |> 
  correlate() |> 
  focus(sugar_content_brix)

```

```{r}
grapes_split <- initial_validation_split(grapes, prop = c(0.6, 0.2))

set.seed(1000)

grapes_train <- training(grapes_split)
grapes_valid <- validation(grapes_split)
grapes_test <- testing(grapes_split)

```

# Exploratory Plot 1/Table 1 (only using 2 or more features, not the target variable)

```{r}
ggplot(grapes, mapping = aes(y = sugar_content_brix, x = berry_size_mm))+
  geom_point()
```

```{r}
if (interactive()) {
    # You do *not* usually need to do this sort of thing
    library(rgl) # need install.packages("rgl"), still might fail
    plot3d(x = grapes$sugar_content_brix, y = grapes$sun_exposure_hours, z = grapes$quality_score)

}
```
